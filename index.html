<!DOCTYPE html>
<html lang="pl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Изучение польского языка - Падежи</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			/* Улучшения для touch-устройств */
			button,
			input,
			.hint-btn {
				-webkit-tap-highlight-color: transparent;
				touch-action: manipulation;
			}

			/* Предотвращение зума на input в iOS */
			input[type='text'] {
				font-size: 16px;
			}

			/* Оптимизация для WebView Telegram */
			@media (max-width: 768px) {
				body {
					/* Предотвращение скролла body при фокусе на input */
					position: relative;
					overflow-x: hidden;
				}

				.container {
					/* Обеспечиваем правильное позиционирование */
					position: relative;
					min-height: 100vh;
				}

				.input-group {
					/* Улучшенное позиционирование поля ввода */
					position: relative;
					z-index: 10;
				}

				.input-group input {
					/* Улучшенная видимость в WebView */
					-webkit-appearance: none;
					border-radius: 10px;
					background: white;
					box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				}
			}

			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				min-height: 100vh;
				padding: 20px;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				background: white;
				border-radius: 20px;
				box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
				overflow: hidden;
			}

			.header {
				background: linear-gradient(135deg, #ff6b6b, #ee5a24);
				color: white;
				padding: 30px;
				text-align: center;
			}

			.header h1 {
				font-size: 2.5rem;
				margin-bottom: 10px;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
			}

			.header p {
				font-size: 1.2rem;
				opacity: 0.9;
			}

			.controls {
				padding: 30px;
				background: #f8f9fa;
				border-bottom: 1px solid #e9ecef;
			}

			.case-selector {
				display: flex;
				gap: 15px;
				flex-wrap: wrap;
				justify-content: center;
				margin-bottom: 20px;
			}

			.case-btn {
				padding: 12px 24px;
				border: none;
				border-radius: 25px;
				background: #007bff;
				color: white;
				cursor: pointer;
				font-size: 1rem;
				transition: all 0.3s ease;
				box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
			}

			.case-btn:hover {
				background: #0056b3;
				transform: translateY(-2px);
				box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
			}

			/* Улучшения для мобильных устройств */
			@media (hover: none) and (pointer: coarse) {
				.case-btn:hover,
				.mixed-btn:hover,
				.hint-btn:hover {
					transform: none;
					box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
				}
			}

			.case-btn.active {
				background: #28a745;
				box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
			}

			.mixed-btn {
				padding: 12px 24px;
				border: none;
				border-radius: 25px;
				background: #007bff;
				color: white;
				cursor: pointer;
				font-size: 1rem;
				transition: all 0.3s ease;
				box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
			}

			.mixed-btn:hover {
				background: #0056b3;
				transform: translateY(-2px);
				box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
			}

			.mixed-btn.active {
				background: #28a745;
				box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
			}

			/* Стили для выпадающего списка */
			.case-select {
				display: none;
				width: 100%;
				max-width: 300px;
				padding: 12px 16px;
				border: 2px solid #e9ecef;
				border-radius: 10px;
				background: white;
				font-size: 1rem;
				color: #495057;
				cursor: pointer;
				transition: border-color 0.3s ease;
				appearance: none;
				background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
				background-repeat: no-repeat;
				background-position: right 12px center;
				background-size: 16px;
				padding-right: 40px;
			}

			.case-select:focus {
				outline: none;
				border-color: #007bff;
				box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
			}

			.case-select option {
				padding: 8px;
				font-size: 1rem;
			}

			.exercise-area {
				padding: 40px;
				text-align: center;
			}

			.word-display {
				background: #f8f9fa;
				padding: 30px;
				border-radius: 15px;
				margin-bottom: 20px;
				border: 2px solid #e9ecef;
			}

			.word-display h3 {
				color: #495057;
				margin-bottom: 15px;
				font-size: 1.3rem;
			}

			.words-line {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 20px;
				flex-wrap: wrap;
				margin-bottom: 15px;
			}

			.word {
				font-size: 1.5rem;
				font-weight: bold;
				color: #007bff;
				padding: 10px 15px;
				background: white;
				border-radius: 10px;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
			}

			.input-section {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 15px;
				margin-bottom: 20px;
			}

			.input-group {
				text-align: center;
				width: 100%;
				max-width: 600px;
				position: relative;
				margin: 0 auto;
			}

			.input-group label {
				display: block;
				margin-bottom: 8px;
				font-weight: bold;
				color: #495057;
				font-size: 1.1rem;
			}

			.input-group input {
				width: 100%;
				padding: 15px;
				border: 2px solid #e9ecef;
				border-radius: 10px;
				font-size: 1.1rem;
				transition: border-color 0.3s ease;
				text-align: center;
			}

			.input-group input:focus {
				outline: none;
				border-color: #007bff;
				box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
			}

			.error-message {
				color: #dc3545;
				font-size: 0.85rem;
				margin-top: 5px;
				text-align: center;
				display: none;
			}

			.success-message {
				color: #28a745;
				font-size: 0.85rem;
				margin-top: 5px;
				text-align: center;
				display: none;
			}

			.hints-section {
				display: flex;
				gap: 15px;
				justify-content: center;
				margin: 15px 0;
			}

			.hint-btn {
				background: #17a2b8;
				color: white;
				border: none;
				padding: 10px 20px;
				border-radius: 20px;
				cursor: pointer;
				transition: all 0.3s ease;
				position: relative;
			}

			.hint-btn:hover {
				background: #138496;
				transform: translateY(-1px);
			}

			.tooltip {
				position: absolute;
				bottom: 100%;
				left: 50%;
				transform: translateX(-50%);
				background: white;
				color: #333;
				padding: 15px;
				border-radius: 8px;
				font-size: 0.9rem;
				white-space: normal;
				opacity: 0;
				visibility: hidden;
				transition: all 0.3s ease;
				z-index: 99999;
				margin-bottom: 10px;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
				border: 1px solid #dee2e6;
				max-width: 300px;
				min-width: 250px;
				max-height: 60vh;
				overflow-y: auto;
			}

			.tooltip::after {
				content: '';
				position: absolute;
				top: 100%;
				left: 50%;
				transform: translateX(-50%);
				border: 5px solid transparent;
				border-top-color: #333;
			}

			.hint-btn:hover .tooltip {
				opacity: 1;
				visibility: visible;
			}

			/* Улучшенные tooltip для мобильных */
			@media (max-width: 768px) {
				.hint-btn:active .tooltip {
					opacity: 1;
					visibility: visible;
				}
			}

			.result {
				margin: 15px 0;
				padding: 20px;
				border-radius: 10px;
				font-size: 1.1rem;
				display: none;
			}

			.result.correct {
				background: #d4edda;
				color: #155724;
				border: 1px solid #c3e6cb;
			}

			.result.incorrect {
				background: #f8d7da;
				color: #721c24;
				border: 1px solid #f5c6cb;
			}

			/* Мобильная оптимизация */
			@media (max-width: 768px) {
				body {
					padding: 10px;
				}

				.container {
					border-radius: 15px;
				}

				.header {
					padding: 20px 15px;
				}

				.header h1 {
					font-size: 1.8rem;
					margin-bottom: 8px;
				}

				.header p {
					font-size: 1rem;
				}

				.controls {
					padding: 20px 15px;
				}

				/* Скрываем кнопки на мобильных */
				.case-btn,
				.mixed-btn {
					display: none;
				}

				/* Показываем выпадающий список */
				.case-select {
					display: block;
				}

				.case-selector {
					flex-direction: column;
					align-items: center;
					gap: 10px;
				}

				.exercise-area {
					padding: 20px 15px;
				}

				.word-display {
					padding: 20px 15px;
					margin-bottom: 15px;
				}

				.word-display h3 {
					font-size: 1.1rem;
					margin-bottom: 10px;
				}

				.words-line {
					flex-direction: column;
					gap: 8px;
					margin-bottom: 10px;
				}

				.word {
					font-size: 1.2rem;
					padding: 8px 12px;
					width: 100%;
					max-width: 280px;
				}

				.input-group {
					max-width: 100%;
				}

				.input-group input {
					padding: 12px;
					font-size: 1rem;
				}

				.hints-section {
					flex-direction: column;
					align-items: center;
					gap: 10px;
					margin: 10px 0;
				}

				.hint-btn {
					width: 100%;
					max-width: 200px;
					padding: 12px 16px;
					font-size: 0.9rem;
				}

				.tooltip {
					position: fixed;
					bottom: 20px;
					top: auto;
					left: 50%;
					transform: translateX(-50%);
					width: 90%;
					max-width: 350px;
					white-space: normal;
					text-align: center;
					z-index: 99999;
					padding: 20px;
					max-height: 60vh;
					overflow-y: auto;
				}

				.tooltip::after {
					display: none;
				}

				.result {
					padding: 15px;
					font-size: 1rem;
					margin: 10px 0;
				}
			}

			/* Планшеты */
			@media (min-width: 769px) and (max-width: 1024px) {
				body {
					padding: 15px;
				}

				.header h1 {
					font-size: 2.2rem;
				}

				.case-selector {
					gap: 12px;
				}

				.case-btn,
				.mixed-btn {
					padding: 14px 22px;
					font-size: 0.98rem;
				}

				.words-line {
					gap: 15px;
				}

				.word {
					font-size: 1.3rem;
				}

				.hints-section {
					gap: 12px;
				}
			}

			/* Планшеты - также используем выпадающий список */
			@media (max-width: 1024px) {
				.case-btn,
				.mixed-btn {
					display: none;
				}

				.case-select {
					display: block;
				}
			}

			/* Очень маленькие экраны */
			@media (max-width: 480px) {
				body {
					padding: 5px;
				}

				.header {
					padding: 15px 10px;
				}

				.header h1 {
					font-size: 1.5rem;
				}

				.header p {
					font-size: 0.9rem;
				}

				.controls {
					padding: 15px 10px;
				}

				.exercise-area {
					padding: 15px 10px;
				}

				.word-display {
					padding: 15px 10px;
				}

				.word {
					font-size: 1.1rem;
					padding: 6px 10px;
				}

				.case-select {
					font-size: 0.9rem;
					padding: 10px 14px;
				}

				.hint-btn {
					padding: 10px 14px;
					font-size: 0.85rem;
				}

				.input-group input {
					padding: 12px;
					font-size: 0.95rem;
					/* Улучшенная видимость на маленьких экранах */
					border: 2px solid #007bff;
					background: #f8f9fa;
				}

				/* Компактная таблица для очень маленьких экранов */
				.tooltip {
					max-height: 50vh;
					padding: 15px;
				}

				.tooltip table {
					font-size: 9px;
				}

				.tooltip td {
					padding: 1px 3px;
				}
			}

			/* Ландшафтная ориентация на мобильных */
			@media (max-width: 768px) and (orientation: landscape) {
				.header {
					padding: 15px;
				}

				.header h1 {
					font-size: 1.6rem;
				}

				.case-selector {
					flex-direction: row;
					flex-wrap: wrap;
					justify-content: center;
				}

				.case-btn {
					width: auto;
					max-width: none;
					flex: 0 0 auto;
				}

				.words-line {
					flex-direction: row;
					flex-wrap: wrap;
					justify-content: center;
				}

				.word {
					width: auto;
					max-width: none;
				}

				.hints-section {
					flex-direction: row;
					flex-wrap: wrap;
					justify-content: center;
				}

				.hint-btn {
					width: auto;
					max-width: none;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="header">
				<h1>🇵🇱 Изучение польского языка</h1>
				<p>
					Вам будут показаны глагол, прилагательное и существительное в инфинитиве. Определите падеж по
					глаголу и введите слова с правильными окончаниями в текстовое поле.
				</p>
			</div>

			<div class="controls">
				<div class="case-selector">
					<select class="case-select" id="caseSelect">
						<option value="mixed" selected>🔄 Изучать все падежи в перемешку</option>
						<option value="dopelniacz">Dopełniacz (Родительный)</option>
						<option value="celownik">Celownik (Дательный)</option>
						<option value="biernik">Biernik (Винительный)</option>
						<option value="narzednik">Narzędnik (Творительный)</option>
						<option value="miejscownik">Miejscownik (Местный)</option>
						<option value="wolacz">Wołacz (Звательный)</option>
					</select>
					<button class="case-btn" data-case="dopelniacz">Dopełniacz (Родительный)</button>
					<button class="case-btn" data-case="celownik">Celownik (Дательный)</button>
					<button class="case-btn" data-case="biernik">Biernik (Винительный)</button>
					<button class="case-btn" data-case="narzednik">Narzędnik (Творительный)</button>
					<button class="case-btn" data-case="miejscownik">Miejscownik (Местный)</button>
					<button class="case-btn" data-case="wolacz">Wołacz (Звательный)</button>
					<button class="mixed-btn" id="mixedBtn">🔄 Изучать все падежи в перемешку</button>
				</div>
			</div>

			<div class="exercise-area">
				<div class="word-display" id="wordDisplay" style="display: none">
					<div class="words-line">
						<div class="word" id="verb">Глагол</div>
						<div class="word" id="adjective">Прилагательное</div>
						<div class="word" id="noun">Существительное</div>
					</div>
					<div class="input-group">
						<input type="text" id="answerInput" placeholder="" />
						<div class="error-message" id="errorMessage"></div>
						<div class="success-message" id="successMessage"></div>
					</div>
				</div>

				<div class="hints-section" id="hintsSection" style="display: none">
					<button class="hint-btn" id="caseHintBtn">
						💡 Падеж
						<div class="tooltip" id="caseTooltip">Наведите для подсказки</div>
					</button>
					<button class="hint-btn" id="questionHintBtn">
						❓ Вопрос
						<div class="tooltip" id="questionTooltip">Наведите для подсказки</div>
					</button>
					<button class="hint-btn" id="ruleHintBtn">
						📚 Правило
						<div class="tooltip" id="ruleTooltip">Наведите для подсказки</div>
					</button>
				</div>

				<div class="result" id="result"></div>
			</div>
		</div>

		<script src="words-database.js"></script>
		<script>
			let currentCase = null;
			let isMixedMode = false;
			let availableWords = [];
			let currentAttempts = 0;
			let stats = {
				correct: 0,
				incorrect: 0,
				total: 0
			};

			// Инициализация
			document.addEventListener('DOMContentLoaded', function () {
				initializeApp();
			});

			function initializeApp() {
				// Добавляем обработчики для кнопок падежей
				document.querySelectorAll('.case-btn').forEach((btn) => {
					btn.addEventListener('click', function () {
						selectCase(this.dataset.case);
					});
				});

				// Добавляем обработчик для кнопки смешанного режима
				document.getElementById('mixedBtn').addEventListener('click', selectMixedMode);

				// Добавляем обработчик для выпадающего списка
				document.getElementById('caseSelect').addEventListener('change', function () {
					const selectedCase = this.value;
					if (selectedCase) {
						if (selectedCase === 'mixed') {
							selectMixedMode();
						} else {
							selectCase(selectedCase);
						}
						// Возвращаем к смешанному режиму по умолчанию
						this.value = 'mixed';
					}
				});

				// Автоматически выбираем смешанный режим при загрузке
				selectMixedMode();
			}

			function selectCase(caseName) {
				// Убираем активный класс со всех кнопок
				document.querySelectorAll('.case-btn').forEach((btn) => {
					btn.classList.remove('active');
				});
				document.getElementById('mixedBtn').classList.remove('active');

				// Добавляем активный класс к выбранной кнопке
				document.querySelector(`[data-case="${caseName}"]`).classList.add('active');

				// Обновляем выпадающий список
				const caseSelect = document.getElementById('caseSelect');
				if (caseSelect) {
					caseSelect.value = '';
				}

				currentCase = caseName;
				isMixedMode = false;
				currentAttempts = 0;

				// Инициализируем доступные слова для выбранного падежа
				availableWords = [...extendedWordDatabase[caseName].examples];
				shuffleArray(availableWords);

				// Показываем упражнение
				showExercise();
			}

			function selectMixedMode() {
				// Убираем активный класс со всех кнопок падежей
				document.querySelectorAll('.case-btn').forEach((btn) => {
					btn.classList.remove('active');
				});

				// Добавляем активный класс к кнопке смешанного режима
				document.getElementById('mixedBtn').classList.add('active');

				// Обновляем выпадающий список
				const caseSelect = document.getElementById('caseSelect');
				if (caseSelect) {
					caseSelect.value = 'mixed';
				}

				isMixedMode = true;
				currentCase = null;
				currentAttempts = 0;

				// Создаем массив всех слов из всех падежей
				availableWords = [];
				Object.keys(extendedWordDatabase).forEach((caseName) => {
					extendedWordDatabase[caseName].examples.forEach((word) => {
						availableWords.push({
							...word,
							caseName: caseName,
							caseInfo: extendedWordDatabase[caseName]
						});
					});
				});

				// Перемешиваем слова
				shuffleArray(availableWords);

				showExercise();
			}

			function shuffleArray(array) {
				const shuffled = [...array];
				for (let i = shuffled.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
				}
				return shuffled;
			}

			let currentWord = null; // Глобальная переменная для текущего слова

			function showExercise() {
				if (availableWords.length === 0) {
					// Если все слова пройдены, начинаем новый цикл
					if (isMixedMode) {
						// Перемешиваем все слова заново
						Object.keys(extendedWordDatabase).forEach((caseName) => {
							extendedWordDatabase[caseName].examples.forEach((word) => {
								availableWords.push({
									...word,
									caseName: caseName,
									caseInfo: extendedWordDatabase[caseName]
								});
							});
						});
						shuffleArray(availableWords);
						alert('Поздравляем! Вы прошли все слова. Начинаем новый цикл! 🎊');
					} else {
						// Перемешиваем слова для выбранного падежа заново
						availableWords = [...extendedWordDatabase[currentCase].examples];
						shuffleArray(availableWords);
						alert('Поздравляем! Вы прошли все слова для этого падежа. Начинаем новый цикл! 🎊');
					}
				}

				// Выбираем случайное слово из доступных
				const randomIndex = Math.floor(Math.random() * availableWords.length);
				currentWord = availableWords[randomIndex]; // Сохраняем в глобальную переменную
				const caseData = isMixedMode ? currentWord.caseInfo : extendedWordDatabase[currentCase];

				document.getElementById('verb').textContent = currentWord.verb;
				document.getElementById('adjective').textContent = currentWord.adjective;
				document.getElementById('noun').textContent = currentWord.noun;

				// Обновляем подсказки
				updateHints(currentWord, caseData);

				// Скрываем сообщения об ошибке и успехе
				document.getElementById('errorMessage').style.display = 'none';
				document.getElementById('successMessage').style.display = 'none';

				// Сбрасываем счетчик попыток
				currentAttempts = 0;

				document.getElementById('wordDisplay').style.display = 'block';
				document.getElementById('hintsSection').style.display = 'flex';
				document.getElementById('result').style.display = 'none';

				// Устанавливаем глагол как текст в поле ввода с пробелом после
				document.getElementById('answerInput').value = currentWord.verb + ' ';
				document.getElementById('answerInput').focus();

				// Автоматическая прокрутка к полю ввода на мобильных устройствах
				setTimeout(() => {
					document.getElementById('answerInput').scrollIntoView({
						behavior: 'smooth',
						block: 'center'
					});
				}, 100);
			}

			function updateHints(currentWord, caseData) {
				// Обновляем подсказку падежа
				document.getElementById('caseTooltip').textContent = caseData.name;

				// Обновляем подсказку вопроса (вопросы на польском)
				document.getElementById('questionTooltip').textContent = getCaseQuestions(caseData.name);

				// Обновляем подсказку правила (окончания) - используем innerHTML для таблицы
				document.getElementById('ruleTooltip').innerHTML = getCaseEndings(caseData.name);
			}

			function getCaseQuestions(caseName) {
				// Извлекаем только польское название падежа (до скобки)
				const polishCaseName = caseName.split(' (')[0];

				const questions = {
					Dopełniacz: 'Kogo? Czego?',
					Celownik: 'Komu? Czemu?',
					Biernik: 'Kogo? Co?',
					Narzędnik: 'Kim? Czym?',
					Miejscownik: 'O kim? O czym?',
					Wołacz: 'O!'
				};

				return questions[polishCaseName] || 'Вопросы для данного падежа';
			}

			function getCaseEndings(caseName) {
				// Извлекаем только польское название падежа (до скобки)
				const polishCaseName = caseName.split(' (')[0];

				const caseEndings = {
					Dopełniacz: {
						title: 'Dopełniacz (Родительный)',
						questions: 'kogo? czego?',
						singular: {
							masculine: '-a, -u',
							feminine: '-y, -i',
							neuter: '-a, -u'
						},
						plural: {
							masculine: '-ów, -i',
							feminine: '-',
							neuter: '-ów, -'
						}
					},
					Celownik: {
						title: 'Celownik (Дательный)',
						questions: 'komu? czemu?',
						singular: {
							masculine: '-owi, -u',
							feminine: '-ej, -y',
							neuter: '-u'
						},
						plural: {
							masculine: '-om',
							feminine: '-om',
							neuter: '-om'
						}
					},
					Biernik: {
						title: 'Biernik (Винительный)',
						questions: 'kogo? co?',
						singular: {
							masculine: '-a, -',
							feminine: '-ę, -',
							neuter: '-o, -e'
						},
						plural: {
							masculine: '-ów, -y',
							feminine: '-y, -e',
							neuter: '-a, -e'
						}
					},
					Narzędnik: {
						title: 'Narzędnik (Творительный)',
						questions: 'kim? czym?',
						singular: {
							masculine: '-em',
							feminine: '-ą',
							neuter: '-em'
						},
						plural: {
							masculine: '-ami',
							feminine: '-ami',
							neuter: '-ami'
						}
					},
					Miejscownik: {
						title: 'Miejscownik (Местный)',
						questions: 'o kim? o czym?',
						singular: {
							masculine: '-ie, -u',
							feminine: '-ie, -y',
							neuter: '-ie, -u'
						},
						plural: {
							masculine: '-ach',
							feminine: '-ach',
							neuter: '-ach'
						}
					},
					Wołacz: {
						title: 'Wołacz (Звательный)',
						questions: 'O!',
						singular: {
							masculine: '-e, -u',
							feminine: '-o, -y',
							neuter: '-o, -e'
						},
						plural: {
							masculine: '-owie, -y',
							feminine: '-y',
							neuter: '-a'
						}
					}
				};

				const caseData = caseEndings[polishCaseName];
				if (!caseData) return 'Окончания для данного падежа';

				return `
					<div style="font-size: 12px; line-height: 1.3;">
						<div style="font-weight: bold; margin-bottom: 8px; color: #007bff;">${caseData.title}</div>
						<div style="margin-bottom: 8px; font-style: italic;">${caseData.questions}</div>
						<table style="border-collapse: collapse; width: 100%; font-size: 11px;">
							<tr style="background: #f8f9fa; border: 1px solid #dee2e6;">
								<td style="padding: 4px; border: 1px solid #dee2e6; font-weight: bold;">Род</td>
								<td style="padding: 4px; border: 1px solid #dee2e6; font-weight: bold;">Ед. число</td>
								<td style="padding: 4px; border: 1px solid #dee2e6; font-weight: bold;">Мн. число</td>
							</tr>
							<tr style="border: 1px solid #dee2e6;">
								<td style="padding: 4px; border: 1px solid #dee2e6;">Мужской</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.singular.masculine}</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.plural.masculine}</td>
							</tr>
							<tr style="background: #f8f9fa; border: 1px solid #dee2e6;">
								<td style="padding: 4px; border: 1px solid #dee2e6;">Женский</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.singular.feminine}</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.plural.feminine}</td>
							</tr>
							<tr style="border: 1px solid #dee2e6;">
								<td style="padding: 4px; border: 1px solid #dee2e6;">Средний</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.singular.neuter}</td>
								<td style="padding: 4px; border: 1px solid #dee2e6;">${caseData.plural.neuter}</td>
							</tr>
						</table>
					</div>
				`;
			}

			function checkAnswer() {
				const answerInput = document.getElementById('answerInput').value.trim().toLowerCase();

				// Используем глобальную переменную currentWord
				const caseData = isMixedMode ? currentWord.caseInfo : extendedWordDatabase[currentCase];

				// Убираем глагол из начала ответа для проверки
				const answerWithoutVerb = answerInput.replace(currentWord.verb.toLowerCase() + ' ', '').trim();
				const correctAnswer = `${currentWord.adjAnswer} ${currentWord.nounAnswer}`.toLowerCase();
				const isCorrect = answerWithoutVerb === correctAnswer;

				if (isCorrect) {
					stats.correct++;

					// Показываем сообщение об успехе под полем ввода
					const successMessage = document.getElementById('successMessage');
					successMessage.textContent = 'Правильно! Отличная работа! 🎉';
					successMessage.style.display = 'block';

					// Удаляем правильно отвеченное слово из доступных
					const wordIndex = availableWords.findIndex((word) => word === currentWord);
					if (wordIndex !== -1) {
						availableWords.splice(wordIndex, 1);
					}

					// Автоматически переходим к следующему слову через 1 секунду
					setTimeout(() => {
						nextWord();
					}, 1000);
				} else {
					currentAttempts++;
					stats.incorrect++;

					// Показываем сообщение об ошибке под полем ввода
					const errorMessage = document.getElementById('errorMessage');
					errorMessage.textContent = `Неправильно. Попытка ${currentAttempts} из 3. Попробуйте еще раз!`;
					errorMessage.style.display = 'block';

					if (currentAttempts >= 3) {
						// После 3-й попытки показываем правильный ответ под полем ввода
						const errorMessage = document.getElementById('errorMessage');
						errorMessage.innerHTML = `Правильный ответ: <strong>${currentWord.adjAnswer} ${currentWord.nounAnswer}</strong><br>Нажмите Enter или кликните в любое место для перехода к следующему слову`;
						errorMessage.style.display = 'block';
					}
				}

				stats.total++;
			}

			function showResult(message, type) {
				const resultDiv = document.getElementById('result');
				resultDiv.innerHTML = message;
				resultDiv.className = `result ${type}`;
				resultDiv.style.display = 'block';

				// Скрываем сообщения об ошибке и успехе при показе результата
				document.getElementById('errorMessage').style.display = 'none';
				document.getElementById('successMessage').style.display = 'none';
			}

			function nextWord() {
				showExercise();
			}

			// Добавляем поддержку Enter для проверки
			document.addEventListener('keypress', function (e) {
				if (e.key === 'Enter') {
					if (currentAttempts >= 3) {
						// После 3-х ошибок Enter переходит к следующему слову
						nextWord();
					} else {
						// Иначе проверяем ответ
						checkAnswer();
					}
				}
			});

			// Добавляем поддержку клика для перехода к следующему слову на мобильных
			document.addEventListener('click', function (e) {
				// Проверяем, что это не клик по интерактивным элементам
				if (
					currentAttempts >= 3 &&
					!e.target.closest('.hint-btn') &&
					!e.target.closest('#answerInput') &&
					!e.target.closest('.case-btn') &&
					!e.target.closest('.mixed-btn') &&
					!e.target.closest('.case-select') &&
					!e.target.closest('.tooltip')
				) {
					nextWord();
				}
			});

			// Автоматическая прокрутка к полю ввода при фокусе
			document.getElementById('answerInput').addEventListener('focus', function () {
				setTimeout(() => {
					this.scrollIntoView({
						behavior: 'smooth',
						block: 'center',
						inline: 'nearest'
					});
				}, 300);
			});
		</script>
	</body>
</html>
